{"version":3,"file":"dictionary-builder.js","sources":["../../../../../../../node_modules/arquero/src/arrow/builder/dictionary-builder.js"],"sourcesContent":["import utf8Builder from './utf8-builder';\nimport { array, arrowVector } from './util';\n\nexport default function(type, length) {\n  const values = [];\n  const data = array(type.indices.ArrayType, length);\n  const keys = Object.create(null);\n\n  let next = -1;\n  let strlen = 0;\n\n  return {\n    set(value, index) {\n      const v = String(value);\n      let k = keys[v];\n      if (k === undefined) {\n        strlen += v.length;\n        keys[v] = k = ++next;\n        values.push(v);\n      }\n      data[index] = k;\n    },\n    data: () => ({\n      type,\n      length,\n      buffers: [null, data],\n      dict: dictionary(type.dictionary, values, strlen)\n    })\n  };\n}\n\nfunction dictionary(type, values, strlen) {\n  const b = utf8Builder(type, values.length, strlen);\n  values.forEach(b.set);\n  return arrowVector(b.data());\n}"],"names":[],"mappings":";;;;;;;;;AAGe,0BAAQ,CAAC,IAAI,EAAE,MAAM,EAAE;AACtC,EAAE,MAAM,MAAM,GAAG,EAAE,CAAC;AACpB,EAAE,MAAM,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;AACrD,EAAE,MAAM,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;AACnC;AACA,EAAE,IAAI,IAAI,GAAG,CAAC,CAAC,CAAC;AAChB,EAAE,IAAI,MAAM,GAAG,CAAC,CAAC;AACjB;AACA,EAAE,OAAO;AACT,IAAI,GAAG,CAAC,KAAK,EAAE,KAAK,EAAE;AACtB,MAAM,MAAM,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;AAC9B,MAAM,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;AACtB,MAAM,IAAI,CAAC,KAAK,SAAS,EAAE;AAC3B,QAAQ,MAAM,IAAI,CAAC,CAAC,MAAM,CAAC;AAC3B,QAAQ,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC;AAC7B,QAAQ,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AACvB,OAAO;AACP,MAAM,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;AACtB,KAAK;AACL,IAAI,IAAI,EAAE,OAAO;AACjB,MAAM,IAAI;AACV,MAAM,MAAM;AACZ,MAAM,OAAO,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC;AAC3B,MAAM,IAAI,EAAE,UAAU,CAAC,IAAI,CAAC,UAAU,EAAE,MAAM,EAAE,MAAM,CAAC;AACvD,KAAK,CAAC;AACN,GAAG,CAAC;AACJ,CAAC;AACD;AACA,SAAS,UAAU,CAAC,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE;AAC1C,EAAE,MAAM,CAAC,GAAG,WAAW,CAAC,IAAI,EAAE,MAAM,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;AACrD,EAAE,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;AACxB,EAAE,OAAO,WAAW,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC;AAC/B;;;;","x_google_ignoreList":[0]}