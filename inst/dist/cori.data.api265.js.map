{"version":3,"file":"cori.data.api265.js","sources":["../../node_modules/apache-arrow/row/map.mjs"],"sourcesContent":["// Licensed to the Apache Software Foundation (ASF) under one\n// or more contributor license agreements.  See the NOTICE file\n// distributed with this work for additional information\n// regarding copyright ownership.  The ASF licenses this file\n// to you under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance\n// with the License.  You may obtain a copy of the License at\n//\n//   http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing,\n// software distributed under the License is distributed on an\n// \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied.  See the License for the\n// specific language governing permissions and limitations\n// under the License.\nimport { Vector } from '../vector.mjs';\nimport { valueToString } from '../util/pretty.mjs';\nimport { instance as getVisitor } from '../visitor/get.mjs';\nimport { instance as setVisitor } from '../visitor/set.mjs';\n/** @ignore */ export const kKeys = Symbol.for('keys');\n/** @ignore */ export const kVals = Symbol.for('vals');\nexport class MapRow {\n    constructor(slice) {\n        this[kKeys] = new Vector([slice.children[0]]).memoize();\n        this[kVals] = slice.children[1];\n        return new Proxy(this, new MapRowProxyHandler());\n    }\n    [Symbol.iterator]() {\n        return new MapRowIterator(this[kKeys], this[kVals]);\n    }\n    get size() { return this[kKeys].length; }\n    toArray() { return Object.values(this.toJSON()); }\n    toJSON() {\n        const keys = this[kKeys];\n        const vals = this[kVals];\n        const json = {};\n        for (let i = -1, n = keys.length; ++i < n;) {\n            json[keys.get(i)] = getVisitor.visit(vals, i);\n        }\n        return json;\n    }\n    toString() {\n        return `{${[...this].map(([key, val]) => `${valueToString(key)}: ${valueToString(val)}`).join(', ')}}`;\n    }\n    [Symbol.for('nodejs.util.inspect.custom')]() {\n        return this.toString();\n    }\n}\nclass MapRowIterator {\n    constructor(keys, vals) {\n        this.keys = keys;\n        this.vals = vals;\n        this.keyIndex = 0;\n        this.numKeys = keys.length;\n    }\n    [Symbol.iterator]() { return this; }\n    next() {\n        const i = this.keyIndex;\n        if (i === this.numKeys) {\n            return { done: true, value: null };\n        }\n        this.keyIndex++;\n        return {\n            done: false,\n            value: [\n                this.keys.get(i),\n                getVisitor.visit(this.vals, i),\n            ]\n        };\n    }\n}\n/** @ignore */\nclass MapRowProxyHandler {\n    isExtensible() { return false; }\n    deleteProperty() { return false; }\n    preventExtensions() { return true; }\n    ownKeys(row) {\n        return row[kKeys].toArray().map(String);\n    }\n    has(row, key) {\n        return row[kKeys].includes(key);\n    }\n    getOwnPropertyDescriptor(row, key) {\n        const idx = row[kKeys].indexOf(key);\n        if (idx !== -1) {\n            return { writable: true, enumerable: true, configurable: true };\n        }\n        return;\n    }\n    get(row, key) {\n        // Look up key in row first\n        if (Reflect.has(row, key)) {\n            return row[key];\n        }\n        const idx = row[kKeys].indexOf(key);\n        if (idx !== -1) {\n            const val = getVisitor.visit(Reflect.get(row, kVals), idx);\n            // Cache key/val lookups\n            Reflect.set(row, key, val);\n            return val;\n        }\n    }\n    set(row, key, val) {\n        const idx = row[kKeys].indexOf(key);\n        if (idx !== -1) {\n            setVisitor.visit(Reflect.get(row, kVals), idx, val);\n            // Cache key/val lookups\n            return Reflect.set(row, key, val);\n        }\n        else if (Reflect.has(row, key)) {\n            return Reflect.set(row, key, val);\n        }\n        return false;\n    }\n}\nObject.defineProperties(MapRow.prototype, {\n    [Symbol.toStringTag]: { enumerable: false, configurable: false, value: 'Row' },\n    [kKeys]: { writable: true, enumerable: false, configurable: false, value: null },\n    [kVals]: { writable: true, enumerable: false, configurable: false, value: null },\n});\n\n//# sourceMappingURL=map.mjs.map\n"],"names":["kKeys","kVals","MapRow","slice","Vector","MapRowProxyHandler","MapRowIterator","keys","vals","json","i","n","getVisitor","key","val","valueToString","row","idx","setVisitor"],"mappings":"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","x_google_ignoreList":[0]}