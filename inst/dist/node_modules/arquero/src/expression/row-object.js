/*
 * CORI Data API component library
 * {@link https://github.com/ruralinnovation/cori.data.api}
 * @copyright Rural Innovation Strategies, Inc.
 * @license ISC
 */
import { ObjectExpression, Property, Literal } from './ast/constants.js';
import codegen from './codegen.js';
import compile from './compile.js';
import rewrite from './rewrite.js';
import entries from '../util/entries.js';
import isArray from '../util/is-array.js';
import toString from '../util/to-string.js';

const ROW_OBJECT = 'row_object';

function rowObjectExpression(node, props) {
  node.type = ObjectExpression;

  const p = node.properties = [];
  for (const prop of entries(props)) {
    const [name, key] = isArray(prop) ? prop : [prop, prop];
    p.push({
      type: Property,
      key: { type: Literal, raw: toString(key) },
      value: rewrite({ computed: true }, name)
    });
  }

  return node;
}

function rowObjectCode(props) {
  return codegen(rowObjectExpression({}, props));
}

function rowObjectBuilder(props) {
  return compile.expr(rowObjectCode(props));
}

export { ROW_OBJECT, rowObjectBuilder, rowObjectCode, rowObjectExpression };
//# sourceMappingURL=row-object.js.map
