{"version":3,"file":"GeocoderControl.js","sources":["../../../../lib/@cori-risi/components/GeocoderControl.tsx"],"sourcesContent":["import * as React from 'react';\nimport {SetStateAction, useState} from 'react';\nimport {useControl, Marker, MarkerProps, ControlPosition} from 'react-map-gl';\nimport MapboxGeocoder, {GeocoderOptions} from '@mapbox/mapbox-gl-geocoder';\n\ntype GeocoderControlProps = Omit<GeocoderOptions, 'accessToken' | 'mapboxgl' | 'marker'> & {\n  mapboxAccessToken: string;\n  marker?: boolean | Omit<MarkerProps, 'longitude' | 'latitude'>;\n\n  position: ControlPosition;\n\n  onLoading?: (e: object) => void;\n  onResults?: (e: object) => void;\n  onResult?: (e: object) => void;\n  onError?: (e: object) => void;\n};\n\n/* eslint-disable complexity,max-statements */\nexport default function GeocoderControl(props: GeocoderControlProps) {\n  const [marker, setMarker] = useState(null);\n\n  const geocoder = useControl<MapboxGeocoder>(\n    () => {\n      const ctrl = new MapboxGeocoder({\n        ...props,\n        marker: false,\n        accessToken: props.mapboxAccessToken\n      });\n      if (!!props.onLoading) ctrl.on('loading', props.onLoading);\n      if (!!props.onResults) ctrl.on('results', props.onResults);\n      if (!!props.onResult) ctrl.on('result', evt => {\n        if (props.onResult !== undefined) props.onResult(evt);\n\n        const {result} = evt;\n        const location =\n            result &&\n            (result.center || (result.geometry?.type === 'Point' && result.geometry.coordinates));\n        if (location && props.marker) {\n          const markerProps = typeof props.marker === 'object' ? props.marker : {};\n          setMarker(<Marker {...markerProps} longitude={location[0]} latitude={location[1]}/> as unknown as SetStateAction<null>);\n        } else {\n          setMarker(null);\n        }\n      });\n      if (!!props.onError) ctrl.on('error', props.onError);\n      return ctrl;\n    },\n    {\n      position: props.position\n    }\n  );\n\n  // @ts-ignore (TS2339) private member\n  if (geocoder._map) {\n    if (geocoder.getProximity() !== props.proximity && props.proximity !== undefined) {\n      geocoder.setProximity(props.proximity);\n    }\n    if (geocoder.getRenderFunction() !== props.render && props.render !== undefined) {\n      geocoder.setRenderFunction(props.render);\n    }\n    if (geocoder.getLanguage() !== props.language && props.language !== undefined) {\n      geocoder.setLanguage(props.language);\n    }\n    if (geocoder.getZoom() !== props.zoom && props.zoom !== undefined) {\n      geocoder.setZoom(props.zoom);\n    }\n    if (geocoder.getFlyTo() !== props.flyTo && props.flyTo !== undefined) {\n      geocoder.setFlyTo(props.flyTo);\n    }\n    if (geocoder.getPlaceholder() !== props.placeholder && props.placeholder !== undefined) {\n      geocoder.setPlaceholder(props.placeholder);\n    }\n    if (geocoder.getCountries() !== props.countries && props.countries !== undefined) {\n      geocoder.setCountries(props.countries);\n    }\n    if (geocoder.getTypes() !== props.types && props.types !== undefined) {\n      geocoder.setTypes(props.types);\n    }\n    if (geocoder.getMinLength() !== props.minLength && props.minLength !== undefined) {\n      geocoder.setMinLength(props.minLength);\n    }\n    if (geocoder.getLimit() !== props.limit && props.limit !== undefined) {\n      geocoder.setLimit(props.limit);\n    }\n    if (geocoder.getFilter() !== props.filter && props.filter !== undefined) {\n      geocoder.setFilter(props.filter);\n    }\n    if (geocoder.getOrigin() !== props.origin && props.origin !== undefined) {\n      geocoder.setOrigin(props.origin);\n    }\n    // Types missing from @types/mapbox__mapbox-gl-geocoder\n    // if (geocoder.getAutocomplete() !== props.autocomplete && props.autocomplete !== undefined) {\n    //   geocoder.setAutocomplete(props.autocomplete);\n    // }\n    // if (geocoder.getFuzzyMatch() !== props.fuzzyMatch && props.fuzzyMatch !== undefined) {\n    //   geocoder.setFuzzyMatch(props.fuzzyMatch);\n    // }\n    // if (geocoder.getRouting() !== props.routing && props.routing !== undefined) {\n    //   geocoder.setRouting(props.routing);\n    // }\n    // if (geocoder.getWorldview() !== props.worldview && props.worldview !== undefined) {\n    //   geocoder.setWorldview(props.worldview);\n    // }\n  }\n  return marker;\n}\n\nconst noop = () => {};\n"],"names":[],"mappings":"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"}