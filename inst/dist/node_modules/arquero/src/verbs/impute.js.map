{"version":3,"file":"impute.js","sources":["../../../../../../node_modules/arquero/src/verbs/impute.js"],"sourcesContent":["import _impute from '../engine/impute';\nimport _rollup from '../engine/rollup';\nimport parse from '../expression/parse';\nimport parseValues from './util/parse';\nimport { array_agg_distinct } from '../op/op-api';\nimport error from '../util/error';\nimport toString from '../util/to-string';\n\nexport default function(table, values, options = {}) {\n  values = parse(values, { table });\n\n  values.names.forEach(name =>\n    table.column(name) ? 0 : error(`Invalid impute column ${toString(name)}`)\n  );\n\n  if (options.expand) {\n    const opt = { preparse, aggronly: true };\n    const params = parseValues('impute', table, options.expand, opt);\n    const result = _rollup(table.ungroup(), params);\n    return _impute(\n      table, values, params.names,\n      params.names.map(name => result.get(name, 0))\n    );\n  } else {\n    return _impute(table, values);\n  }\n}\n\n// map direct field reference to \"unique\" aggregate\nfunction preparse(map) {\n  map.forEach((value, key) =>\n    value.field ? map.set(key, array_agg_distinct(value + '')) : 0\n  );\n}"],"names":["parseValues"],"mappings":";;;;;;;;;;;;;;AAQe,iBAAQ,CAAC,KAAK,EAAE,MAAM,EAAE,OAAO,GAAG,EAAE,EAAE;AACrD,EAAE,MAAM,GAAG,KAAK,CAAC,MAAM,EAAE,EAAE,KAAK,EAAE,CAAC,CAAC;AACpC;AACA,EAAE,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI;AAC3B,IAAI,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC,CAAC,sBAAsB,EAAE,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;AAC7E,GAAG,CAAC;AACJ;AACA,EAAE,IAAI,OAAO,CAAC,MAAM,EAAE;AACtB,IAAI,MAAM,GAAG,GAAG,EAAE,QAAQ,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;AAC7C,IAAI,MAAM,MAAM,GAAGA,OAAW,CAAC,QAAQ,EAAE,KAAK,EAAE,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;AACrE,IAAI,MAAM,MAAM,GAAG,OAAO,CAAC,KAAK,CAAC,OAAO,EAAE,EAAE,MAAM,CAAC,CAAC;AACpD,IAAI,OAAO,OAAO;AAClB,MAAM,KAAK,EAAE,MAAM,EAAE,MAAM,CAAC,KAAK;AACjC,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,IAAI,MAAM,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;AACnD,KAAK,CAAC;AACN,GAAG,MAAM;AACT,IAAI,OAAO,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;AAClC,GAAG;AACH,CAAC;AACD;AACA;AACA,SAAS,QAAQ,CAAC,GAAG,EAAE;AACvB,EAAE,GAAG,CAAC,OAAO,CAAC,CAAC,KAAK,EAAE,GAAG;AACzB,IAAI,KAAK,CAAC,KAAK,GAAG,GAAG,CAAC,GAAG,CAAC,GAAG,EAAE,kBAAkB,CAAC,KAAK,GAAG,EAAE,CAAC,CAAC,GAAG,CAAC;AAClE,GAAG,CAAC;AACJ;;;;","x_google_ignoreList":[0]}