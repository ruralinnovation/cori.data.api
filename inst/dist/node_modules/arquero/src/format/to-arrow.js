/*
 * CORI Data API component library
 * {@link https://github.com/ruralinnovation/cori.data.api}
 * @copyright Rural Innovation Strategies, Inc.
 * @license ISC
 */
import toArrow from '../arrow/encode/index.js';
import { tableToIPC } from '../../../apache-arrow/ipc/serialization.js';

function toArrowIPC(table, options = {}) {
  const { format: format, ...toArrowOptions } = options;
  const outputFormat = format ? format : 'stream';
  if (!['stream', 'file'].includes(outputFormat)) {
    throw Error('Unrecognised output format');
  }
  return tableToIPC(toArrow(table, toArrowOptions), format);
}

export { toArrow as default, toArrowIPC };
//# sourceMappingURL=to-arrow.js.map
