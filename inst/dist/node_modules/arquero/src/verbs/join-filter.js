/*
 * CORI Data API component library
 * {@link https://github.com/ruralinnovation/cori.data.api}
 * @copyright Rural Innovation Strategies, Inc.
 * @license ISC
 */
import _join_filter from '../engine/join-filter.js';
import { inferKeys, keyPredicate } from './util/join-keys.js';
import parse from '../expression/parse.js';
import isArray from '../util/is-array.js';
import toArray from '../util/to-array.js';

function __semijoin(tableL, tableR, on, options) {
  on = inferKeys(tableL, tableR, on);

  const predicate = isArray(on)
    ? keyPredicate(tableL, tableR, ...on.map(toArray))
    : parse({ on }, { join: [tableL, tableR] }).exprs[0];

  return _join_filter(tableL, tableR, predicate, options);
}

export { __semijoin as default };
//# sourceMappingURL=join-filter.js.map
